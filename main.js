(()=>{"use strict";class e{constructor(e,t){this.length=e,this.health=e,this.sunk=!1,this.id=t}hit(){this.health--,this.isSunk()}isSunk(){0===this.health&&(this.sunk=!0)}}new e(3,0);let t=!1,i=0;const o=new AbortController;class r{constructor(e){this.name=e,this.playerShips=[],this.createPlayerShips()}createPlayerShips(){const t=new e(5,1),i=new e(4,2),o=new e(3,3),r=new e(3,4),n=new e(2,5);this.playerShips.push(t,i,o,r,n)}placePlayerShips(e){let r="vertical";document.querySelector(".toggle-button").addEventListener("click",(()=>{r="vertical"===r?"horizontal":"vertical"})),document.querySelectorAll(".board-piece").forEach((n=>{n.addEventListener("click",(()=>{const c=n.getAttribute("data-x"),l=n.getAttribute("data-y");console.log(`x: ${c}, y: ${l}`);const a=e[c][l];console.log(a),function(e,i,o,r){const{length:n}=e,{id:c}=e;if("vertical"===r){if(o.x+e.length>7||!0===o.occupied)return t=!1,void alert("Ship will not fit on board");if(2===e.length&&i[o.x+e.length-1][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(3===e.length){if(i[o.x+e.length-1][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-2][o.y].occupied)return t=!1,void alert("Ships cannot overlap.")}if(4===e.length){if(i[o.x+e.length-1][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-2][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-3][o.y].occupied)return t=!1,void alert("Ships cannot overlap.")}if(5===e.length){if(i[o.x+e.length-1][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-2][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-3][o.y].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x+e.length-4][o.y].occupied)return t=!1,void alert("Ships cannot overlap.")}o.occupied=!0,o.shipId=c;for(let e=1;e<n;e+=1){const t=i[o.x+e][o.y];t.occupied=!0,t.shipId=c}t=!0}if("horizontal"===r){if(o.y+e.length>7||!0===o.occupied)return t=!1,void alert("Ship will not fit on board");if(2===e.length&&i[o.x][o.y+e.length-1].occupied)return t=!1,void alert("Ships cannot overlap.");if(3===e.length){if(i[o.x][o.y+e.length-1].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-2].occupied)return t=!1,void alert("Ships cannot overlap.")}if(4===e.length){if(i[o.x][o.y+e.length-1].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-2].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-3].occupied)return t=!1,void alert("Ships cannot overlap.")}if(5===e.length){if(i[o.x][o.y+e.length-1].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-2].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-3].occupied)return t=!1,void alert("Ships cannot overlap.");if(i[o.x][o.y+e.length-4].occupied)return t=!1,void alert("Ships cannot overlap.")}o.occupied=!0,o.shipId=c;for(let e=1;e<n;e+=1){const t=i[o.x][o.y+e];t.occupied=!0,t.shipId=c}t=!0}}(this.playerShips[i],e,a,r),function(e){e.forEach((e=>{e.forEach((e=>{e.occupied&&document.querySelector(`[data-x="${e.x}"][data-y="${e.y}"]`).classList.add("occupied")}))}))}(e),t&&i++,console.log("ship count: ",i),5===i&&(console.log("test if triggered"),o.abort())}),{signal:o.signal}),n.addEventListener("mouseover",(e=>{e.target.classList.add("hover");const t=n.getAttribute("data-x"),o=n.getAttribute("data-y");for(let e=1;e<this.playerShips[i].length;e++)"horizontal"===r?document.querySelector(`[data-x="${t}"][data-y="${Number(o)+e}"]`).classList.add("hover"):document.querySelector(`[data-x="${Number(t)+e}"][data-y="${o}"]`).classList.add("hover")}),{signal:o.signal}),n.addEventListener("mouseout",(e=>{e.target.classList.remove("hover");const t=n.getAttribute("data-x"),o=n.getAttribute("data-y");for(let e=1;e<this.playerShips[i].length;e++)"horizontal"===r?document.querySelector(`[data-x="${t}"][data-y="${Number(o)+e}"]`).classList.remove("hover"):document.querySelector(`[data-x="${Number(t)+e}"][data-y="${o}"]`).classList.remove("hover")}),{signal:o.signal})}))}}class n{constructor(e,t){this.hit=!1,this.miss=!1,this.occupied=!1,this.x=e,this.y=t,this.shipId=null}receiveAttack(){this.hit=!0}}function c(e){const t=[];for(let e=0;e<7;e++)for(let i=0;i<7;i++)t[e]=[];for(let e=0;e<7;e++)for(let i=0;i<7;i++)t[e][i]=new n(e,i);if("player"==e){const e=document.querySelector(".gameboard");for(let t=0;t<7;t++)for(let i=0;i<7;i++){const o=document.createElement("div");o.classList.add("board-piece"),o.setAttribute("data-x",t),o.setAttribute("data-y",i),e.appendChild(o)}}else{const e=document.querySelector(".computer-gameboard");for(let t=0;t<7;t++)for(let i=0;i<7;i++){const o=document.createElement("div");o.classList.add("board-piece"),o.setAttribute("data-x",t),o.setAttribute("data-y",i),e.appendChild(o)}}return t}function l(e,t){const i=[].concat.apply([],t),o=Math.random()<.5?"horizontal":"vertical",r=function e(o,r){if("horizontal"===o){const n=Math.floor(Math.random()*i.length),c=i[n];if(!0===c.occupied||c.y+r.length>7)return e(o,r);if(2===r.length&&t[c.x][c.y+r.length-1].occupied)return e(o,r);if(3===r.length){if(t[c.x][c.y+r.length-1].occupied)return e(o,r);if(t[c.x][c.y+r.length-2].occupied)return e(o,r)}if(4===r.length){if(t[c.x][c.y+r.length-1].occupied)return e(o,r);if(t[c.x][c.y+r.length-2].occupied)return e(o,r);if(t[c.x][c.y+r.length-3].occupied)return e(o,r)}if(5===r.length){if(t[c.x][c.y+r.length-1].occupied)return e(o,r);if(t[c.x][c.y+r.length-2].occupied)return e(o,r);if(t[c.x][c.y+r.length-3].occupied)return e(o,r);if(t[c.x][c.y+r.length-4].occupied)return e(o,r)}return c}if("vertical"===o){const n=Math.floor(Math.random()*i.length),c=i[n];if(!0===c.occupied||c.x+r.length>7)return e(o,r);if(2===r.length&&t[c.x+r.length-1][c.y].occupied)return e(o,r);if(3===r.length){if(t[c.x+r.length-1][c.y].occupied)return e(o,r);if(t[c.x+r.length-2][c.y].occupied)return e(o,r)}if(4===r.length){if(t[c.x+r.length-1][c.y].occupied)return e(o,r);if(t[c.x+r.length-2][c.y].occupied)return e(o,r);if(t[c.x+r.length-3][c.y].occupied)return e(o,r)}if(5===r.length){if(t[c.x+r.length-1][c.y].occupied)return e(o,r);if(t[c.x+r.length-2][c.y].occupied)return e(o,r);if(t[c.x+r.length-3][c.y].occupied)return e(o,r);if(t[c.x+r.length-4][c.y].occupied)return e(o,r)}return c}}(o,e);if(r.occupied=!0,r.shipId=e.id,"vertical"===o)for(let i=0;i<e.length;i++)t[r.x+i][r.y].occupied=!0,t[r.x+i][r.y].shipId=e.id;if("horizontal"===o)for(let i=0;i<e.length;i++)t[r.x][r.y+i].occupied=!0,t[r.x][r.y+i].shipId=e.id}let a,u,d;new n(0,0).occupied=!0,document.querySelector("body").onload=function(t){u=c("player"),a=new r("Test Player"),a.placePlayerShips(u),d=c("computer"),function(t){const i=[new e(5,1),new e(4,2),new e(3,3),new e(3,4),new e(2,5)];for(let e=0;e<i.length;e++)l(i[e],t);17!==function(e){return[].concat(...e).filter((e=>!0===e.occupied))}(t).length&&alert("Computer ships not placed correctly")}(d);const i=document.querySelector(".computer-gameboard");d.forEach((e=>{e.forEach((e=>{e.occupied&&i.querySelector(`[data-x="${e.x}"][data-y="${e.y}"]`).classList.add("occupied")}))}))}(),console.log(a),console.log("computer",d)})();