(()=>{"use strict";class t{constructor(t,e){this.length=t,this.health=t,this.sunk=!1,this.id=e}hit(){this.health--,this.isSunk()}isSunk(){0===this.health&&(this.sunk=!0)}}new t(3,0);let e=!1,o=0;const c=new AbortController;class i{constructor(t){this.name=t,this.playerShips=[],this.createPlayerShips()}createPlayerShips(){const e=new t(5,1),o=new t(4,2),c=new t(3,3),i=new t(3,4),r=new t(2,5);this.playerShips.push(e,o,c,i,r)}placePlayerShips(t){let i="vertical";document.querySelector(".toggle-button").addEventListener("click",(()=>{i="vertical"===i?"horizontal":"vertical"})),document.querySelectorAll(".board-piece").forEach((r=>{r.addEventListener("click",(()=>{const a=r.getAttribute("data-x"),n=r.getAttribute("data-y");console.log(`x: ${a}, y: ${n}`);const l=t[a][n];console.log(l),function(t,o,c,i){const{length:r}=t,{id:a}=t;if("vertical"===i){if(c.x+t.length>7||o[c.x+t.length-1][c.y].occupied||!0===c.occupied)return e=!1,void alert("Ship will not fit on board");c.occupied=!0,c.shipId=a;for(let t=1;t<r;t+=1){const e=o[c.x+t][c.y];e.occupied=!0,e.shipId=a}e=!0}if("horizontal"===i){if(c.y+t.length>7||o[c.x][c.y+t.length-1].occupied||!0===c.occupied)return e=!1,void alert("Ship will not fit on board");c.occupied=!0,c.shipId=a;for(let t=1;t<r;t+=1){const e=o[c.x][c.y+t];e.occupied=!0,e.shipId=a}e=!0}}(this.playerShips[o],t,l,i),function(t){t.forEach((t=>{t.forEach((t=>{t.occupied&&document.querySelector(`[data-x="${t.x}"][data-y="${t.y}"]`).classList.add("occupied")}))}))}(t),e&&o++,console.log("ship count: ",o),5===o&&(console.log("test if triggered"),c.abort())}),{signal:c.signal}),r.addEventListener("mouseover",(t=>{t.target.classList.add("hover");const e=r.getAttribute("data-x"),c=r.getAttribute("data-y");for(let t=1;t<this.playerShips[o].length;t++)"horizontal"===i?document.querySelector(`[data-x="${e}"][data-y="${Number(c)+t}"]`).classList.add("hover"):document.querySelector(`[data-x="${Number(e)+t}"][data-y="${c}"]`).classList.add("hover")}),{signal:c.signal}),r.addEventListener("mouseout",(t=>{t.target.classList.remove("hover");const e=r.getAttribute("data-x"),c=r.getAttribute("data-y");for(let t=1;t<this.playerShips[o].length;t++)"horizontal"===i?document.querySelector(`[data-x="${e}"][data-y="${Number(c)+t}"]`).classList.remove("hover"):document.querySelector(`[data-x="${Number(e)+t}"][data-y="${c}"]`).classList.remove("hover")}),{signal:c.signal})}))}}class r{constructor(t,e){this.hit=!1,this.miss=!1,this.occupied=!1,this.x=t,this.y=e,this.shipId=null}receiveAttack(){this.hit=!0}}function a(t){const e=[];for(let t=0;t<7;t++)for(let o=0;o<7;o++)e[t]=[];for(let t=0;t<7;t++)for(let o=0;o<7;o++)e[t][o]=new r(t,o);if("player"==t){const t=document.querySelector(".gameboard");for(let e=0;e<7;e++)for(let o=0;o<7;o++){const c=document.createElement("div");c.classList.add("board-piece"),c.setAttribute("data-x",e),c.setAttribute("data-y",o),t.appendChild(c)}}else{const t=document.querySelector(".computer-gameboard");for(let e=0;e<7;e++)for(let o=0;o<7;o++){const c=document.createElement("div");c.classList.add("board-piece"),c.setAttribute("data-x",e),c.setAttribute("data-y",o),t.appendChild(c)}}return e}function n(t,e){const o=[].concat.apply([],e),c=Math.random()<.5?"horizontal":"vertical",i=function t(c,i){if("horizontal"===c){const r=Math.floor(Math.random()*o.length),a=o[r];return!0===a.occupied||a.y+i.length>7||e[a.x][a.y+i.length-1].occupied?t(c,i):a}if("vertical"===c){const r=Math.floor(Math.random()*o.length),a=o[r];return!0===a.occupied||a.x+i.length>7||e[a.x+i.length-1][a.y].occupied?t(c,i):a}}(c,t);if(i.occupied=!0,i.shipId=t.id,"vertical"===c)for(let o=0;o<t.length;o++)e[i.x+o][i.y].occupied=!0,e[i.x+o][i.y].shipId=t.id;if("horizontal"===c)for(let o=0;o<t.length;o++)e[i.x][i.y+o].occupied=!0,e[i.x][i.y+o].shipId=t.id}let l,s,d;new r(0,0).occupied=!0,document.querySelector("body").onload=function(e){s=a("player"),l=new i("Test Player"),l.placePlayerShips(s),d=a("computer"),function(e){const o=[new t(5,1),new t(4,2),new t(3,3),new t(3,4),new t(2,5)];for(let t=0;t<o.length;t++)n(o[t],e);17!==function(t){return[].concat(...t).filter((t=>!0===t.occupied))}(e).length&&alert("Computer ships not placed correctly")}(d);const o=document.querySelector(".computer-gameboard");d.forEach((t=>{t.forEach((t=>{t.occupied&&o.querySelector(`[data-x="${t.x}"][data-y="${t.y}"]`).classList.add("occupied")}))}))}(),console.log(l),console.log("computer",d)})();